# 관리, 모니터링 및 거버넌스

### CloudWatch
- AWS 클라우드 리소스와 AWS에서 실행되는 애플리케이션을 위한 모니터링 서비스
- 지표를 수집 및 추적하고 로그 파일을 수집 및 모니터링하고 경보를 설정
- EC2 인스턴스, DynamoDB 테이블, RDS 인스턴스 같은 AWS 리소스뿐만 아니라 애플리케이션과 서비스에서 생성된 사용자 정의 지표 및 애플리케이션에서 생성된 모든 로그 파일을 모니터링
- 시스템 전반의 리소스 사용률, 애플리케이션 성능, 운영 상태를 파악
- 지표(Metrics)
    - AWS 클라우드 리소스 및 AWS에서 실행하는 애플리케이션을 모니터링
    - CPU사용량, 네트워크 사용량 등의 AWS 서비스에 대한 측정값
    - AWS 제품 및 서비스에 대한 지표가 자동으로 제공되며 자체 애플리케이션 및 서비스에서 생성된 사용자 정의 지표도 모니터링
- 대시보드(Dashboard)
    - AWS 리소스 및 사용자 정의 지표의 그래프를 한눈에 볼 수 있는 대시보드 기능
- 로그(Logs)
    - 애플리케이션에 대한 로그를 수집하는 기능
    - Lambda, CloudTrail, ECS, API Gateway 등의 AWS 서비스에 대한 로그를 수집
    - AWS 서비스 외에도 Log Agent를 설치하여 로그를 수집 가능
    - 로그를 S3, Kinesis Data Stream, Kinesis Data Firehose, AWS Lambda로 전송 가능
- 경보(Alarms)
    - 지표 값에 대한 알림을 생성하는 기능
    - EC2 인스턴스 CPU 사용률, ELB 요청 지연 시간, DynamoDB 테이블 처리량, SQS 대기열 길이, AWS 청구서 요금에 대한 알림
    - 생성된 알림을 이메일을 전송하거나, SQS 대기열에 게시하거나, Amazon EC2 인스턴스를 중단 또는 종료하거나, Auto Scaling 정책을 실행하도록 경보를 설정

### EventBridge
- 거의 실시간으로 이벤트를 자동 전송 하는 서비스
- 90개 이상의 AWS 서비스에서 이벤트를 자동 수집
- SaaS 애플리케이션 또는 AWS 서비스의 이벤트에 반응하는 애플리케이션을 구축하려고 할 때 사용
- 이벤트 소스에 대한 EventBridge 규칙을 구성하여 AWS SNS 주제에 메시지를 게시하여 관리자에게 이메일로 알림

### CloudTrail
- AWS 계정이 수행하는 작업에 대해 로그를 기록하는 서비스
- AWS 내에서 수행되는 모든 계정 활동에 대해 기록이 됨
- 로그는 CloudWatch Logs 또는 S3 버킷에 저장 가능
- 모든 계정에 기본으로 활성화 되어 있음
- CloudTrail 로그 파일은 KMS 사용하여 암호화 가능
- CloudTrail Insight를 사용하여 AWS 계정에서 비정상적인 활동을 감지 가능
- CloudTrail 로그 파일 무결성 검증 기능을 사용하여 CloudTrail에서 로그 파일을 지정된 S3 버킷으로 전송한 이후로 CloudTrail 로그 파일이 그대로 유지되거나, 삭제되거나, 수정되었는지 확인 가능
- AWS 계정의 거버넌스, 규정 준수, 운영 감사, 위험 감사에 활용

### Config
- AWS 리소스 구성 변경 사항 로그를 기록하는 기능
- 버킷 액세스 변경, 보안 그룹 설정 변경, ALB 설정 변경 등 모든 변경 사항에 대해 로그 수집 가능
- 수집된 로그는 분석, 보안감사를 위해 S3 버킷으로 저장 가능
- 리소스 구성이 변경되면 알림을 SNS 주제로 전송 가능
- Config 규칙을 설정해서 AWS 리소스 구성이 규정준수를 하고 있는지 평가 가능

### System Manger(SSM)
- 서버의 운영 데이터를 수집하는 기능
- 최근 API 작업, 리소스 구성 변경, 관련 알림, 운영 경보, 소프트웨어 인벤토리, 패치 규정 준수 상태 확인
- 보안 패치 업데이트, 방화벽 정책 등의 작업을 자동화
- SSM Session Manager
    - EC2 또는 온프레미스 서버에 대한 원격 연결 기능
    - SSH 키 및 TCP 22번 포트를 사용하지 않고 연결 가능
    - 인스턴스에서 실행된 각 명령을 S3 또는 CloudWatch Log에 기록 가능

### AWS Service Health Dashboard
- AWS 전체 리전, 서비스에 대한 상태를 알려주는 서비스
- https://health.aws.amazon.com/

### AWS Personal Health Dashboard
- Service Health Dashboard는 일반적인 AWS 서비스 상태를 확인
- Personal Health Dashboard는 사용자 AWS 계정에서 사용하는 특정 AWS 서비스의 상태에 대해 개인화된 보기를 제공
- 본인의 AWS 계정에 영향을 줄 수 있는 진행중이거나 예정된 특정 이벤트에 대한 알림을 생성 가능

### Trusted Advisor
- 사용자의 AWS 환경을 조사하여 비용 절감, 시스템 성능 향상 또는 보안 결함 제거를 위한 권장 사항을 제시
- 비용 최적화, 성능, 보안, 내결함성, 서비스한도 5가지 카테고리를 검사
- 비용 최적화
    - 사용되지 않는 유휴 리소스를 제거하거나 예약 용량을 약정하여 AWS에서 비용을 절약할 수 있는 방법을 확인
    - 사용률이 낮거나 사용하지 않는 유휴 상태의 EC2, Load Balancer, RDS, 탄력적 IP 주소 등
- 성능
    - 서비스 한도를 점검하고, 프로비저닝된 처리량을 활용하는지 확인하고, 과다 사용되는 인스턴스를 모니터링하여 서비스 성능을 개선
    - 높은 사용률의 EC2 인스턴스, EC2 보안그룹에 있는 많은 수의 규칙, 인스턴스에 적용된 많은 수의 EC2 보안그룹 규칙, EBS 볼륨 연결 구성 등
- 보안
    - 결함을 없애고, 다양한 AWS 보안 기능을 사용하며, 권한을 점검하여 애플리케이션 보안을 개선
    - 보안 그룹의 제한 없는 특정 포트 또는 액세스, IAM 사용, S3 버킷 권한, 루트계정의 MFA, CloudTrail 로깅, 노출된 액세스 키, RDS 액세스 위험 등
- 내결함성
    - Auto Scaling, 상태 확인, 다중 AZ 및 백업 기능을 활용하여 AWS 애플리케이션의 가용성과 중복성을 높임
    - EBS 스냅샷, EC2 가용 영역 밸런싱, Load Balancer 최적화, Auto Scaling 그룹 상태 확인, S3 버킷 로깅, S3 버킷 버전 관리 등
- 서비스 한도
    - 서비스 한도의 80%가 넘는 서비스 사용량이 있는지 점검
    - DynamoDB 읽기, 쓰기 용량, EBS 스냅샷, 스토리지, EC2 탄력적 IP 주소, 예약 인스턴스 구매 한도, 온디맨드 인스턴스 등

### AWS Orgaziations
- 여러 AWS 계정을 중앙에서 관리
- Organizations는 글로벌 서비스
- 전체 계정을 관리하는 계정을 관리 계정(Master Account)이라고 함
- 그 외의 계정은 멤버 계정이라고 함
- 조직 관리를 위해 OU(Organization Unit)이라는 조직 단위로 그룹화하여 관리
- 그룹마다 서비스 제어 정책(SCP, Service Control Policy)을 적용해서 액세스를 제한해야 하는 서비스를 제어할 수 있음
- 계정을 통합하면 결제를 한 곳으로 통합 가능하고 볼륨 가격 할인을 받을 수 있음
- OU(Organization Unit)
    - OU(Organization Unit)이라는 조직 단위로 그룹화하여 관리 하는 기능
    - 사용중인 AWS계정을 Root OU로 초대하여 멤버 계정으로 만들 수 있음
- SCP(Service Control Policy)
    - 서비스 제어 정책
    - 계정에 대한 AWS 서비스 액세스 제어 정책
    - 계정에 특정 AWS 서비스에 대한 액세스를 제한할 수 있음
    - SCP 정책은 계정 또는 OU 단위에 적용할 수 있음
    - OU에 적용하면 OU에 속한 계정과 OU는 모두 동일한 정책이 적용됨(정책상속)